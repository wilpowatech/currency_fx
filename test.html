<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Exchange Rate Chart Test</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  canvas { max-width: 700px; max-height: 400px; }
</style>
</head>
<body>

<h2>7-Day Exchange Rate Chart</h2>

<canvas id="exchangeChart" width="700" height="400"></canvas>

<script>
async function loadExchangeChart() {
  const base = "USD";
  const target = "EUR";
  const range = 7;

  const labels = [];
  const dataPoints = [];
  const today = new Date();

  for (let i = range - 1; i >= 0; i--) {
    const date = new Date(today);
    date.setDate(today.getDate() - i);
    const formatted = date.toISOString().split("T")[0];
    labels.push(formatted);

    const url = `https://api.exchangerate.host/${formatted}?base=${base}&symbols=${target}`;
    const res = await fetch(url);
    const data = await res.json();

    dataPoints.push(data?.rates?.[target] ?? null);
  }

  const ctx = document.getElementById("exchangeChart").getContext("2d");
  new Chart(ctx, {
    type: "line",
    data: {
      labels,
      datasets: [{
        label: `${base} to ${target}`,
        data: dataPoints,
        borderColor: "#007bff",
        backgroundColor: "#007bff33",
        tension: 0.3,
        fill: true,
      }],
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: "top" },
        tooltip: { mode: "index", intersect: false },
      },
      scales: {
        y: { beginAtZero: false },
      },
    },
  });
}

window.addEventListener("DOMContentLoaded", loadExchangeChart);
</script>

</body>
</html>
